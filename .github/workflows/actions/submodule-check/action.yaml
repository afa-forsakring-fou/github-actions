name: 'Submodule check'
description: 'If repo has our submodule then check for the skip annotation'

runs:
  using: "composite"
  steps:
  - name: Check if submodule and check for 'skip action'
    id: check-submodule
    shell: bash
    run: |
      if ! [[ !$(git submodule status) ]]; then
        exit 0
      fi

      cd shared-tools/makefiles
      if ! [[ $(cat git.mk | grep "skip actions") ]]; then
        exit 1
      fi

  - name: Print error message
    if: failure() && steps.check-submodule.outcome != 'success'
    uses: ./composite-actions/.github/workflows/actions/error-step
    with:
      PRINT: "Pull latest submodule!"
